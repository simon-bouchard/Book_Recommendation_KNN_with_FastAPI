<!DOCTYPE html>
<html lang='en-us'>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>FastAPI test page</title>
	<link rel="stylesheet" href="{{ url_for('static', path='css/styles.css') }}">
</head>

<body>
	<h1>Book Recommendation API</h1>
	<br><br>
	<h2>Profile</h2>
	<br>
	<h3>Post New Rating</h3>
	<form id='ratingForm'>
		<label for='isbn'>Book ISBN:</label>
		<input type='text' id='isbn' name='isbn' required>
		<br><br>
		<label for='rating'>Rating:</label>
		<input type='text' id='rating' name='rating' required>
		<br><br>
		<label for='comment'>Comment: <label>
		<input type='text' id='comment' name='comment'>
		<br><br>
		<button type='submit'>Submit</button>
	</form>

	<script>
	document.getElementById("ratingForm").onsubmit = async function(event) {
    		event.preventDefault();

			let data = {
		   	 	isbn: document.getElementById("isbn").value,
			    rating: document.getElementById("rating").value,
			    comment: document.getElementById("comment").value
			};

    		let response = await fetch("/rating", {
        		method: "POST",
				headers: { 'Content-Type': 'application/json' },
        		body: JSON.stringify(data),
				redirect: 'manual'
    		});

			if (response.redirected) {
				window.location.href = response.url;
			} else {
				let result = await response.json();
				alert(result.message);
			}
};
</script>

	<br><br>
	<a href='/logout'>Logout</a>

</body>
</html>
